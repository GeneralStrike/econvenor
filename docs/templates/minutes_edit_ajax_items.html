{% load setclass %}

<form class="savebyjs" action="" method="POST">
  {% csrf_token %}
  
  {% for item in item_formlist %}

    
    <div class="panel panel-primary" id="id_{{ item.item_no.value}}-title">
      
      <div class="panel-heading">
        <strong>Item&nbsp;{{ item.item_no.value }}.&nbsp;
                {{ item.title.value }}
                {{ item.item.no }}
        </strong>
        <div class="pull-right">
          {{ item.time_limit.value }}&nbsp;minutes		
        </div>
      </div>
      
      <div class="panel-body">
      
        <div class="form-group">
          <div class="well well-sm">
            To be explained by&nbsp;{{ item.explainer.value }}
            <br/>
          </div>
        </div>
        
        <div class="form-group">
          {{ item.background.label_tag }}
          <div class="well">
            {{ item.background.value }}
          </div>
        </div>
        
        <div class="form-group">
          {{ item.minute_notes.label_tag }}
          {{ item.minute_notes|setclass:"form-control" }}
        </div>
        
        {% for hidden in item.hidden_fields %}
          <div class="form-group">
            {{ hidden }}
          </div>
        {% endfor %}


        <p><strong>Decisions:</strong></p>
        
        <div class="panel panel-default">
          {% for decision in decision_formlist %}
            {% ifequal decision.instance.item.id item.instance.id %}
              <div class="form-group">
                {{ decision.label_tag }}
                {{ decision.description|setclass:"form-control" }}
                <button type="button" title="Delete decision" 
                  class="btn btn-default btn-xs ajax-button tltip"
                  id="delete_decision_button_{{ decision.instance.id}}"
                  data-toggle="tooltip" >
                  <span class="glyphicon glyphicon-remove">Delete</span>
                </button>
              </div>
            {% endifequal %}
          {% endfor %}

          <button id="add_decision_button_{{ item.instance.id }}"
            class="btn btn-default ajax-button" type="button">
              Add a decision to this item
          </button>
          
        </div>


        <p><strong>Tasks:</strong></p>
        
        <div class="panel panel-default">
          {% for task in task_formlist %}
            {% ifequal task.instance.item.id item.instance.id %}
              <div class="form-inline" role="form">
                <div class="form-group">
                  {{ task.description|setclass:"form-control" }}
                  {{ task.participant|setclass:"form-control" }}
                  {{ task.deadline|setclass:"form-control" }}
                </div>
              </div>
            {% endifequal %}
          {% endfor %}

          <button id="add_task_button_{{ item.instance.id }}"
            class="btn btn-default ajax-button" type="button">
            Add a task to this item
          </button>
        </div>						

      </div>
    </div>
  {% endfor %}
</form>
