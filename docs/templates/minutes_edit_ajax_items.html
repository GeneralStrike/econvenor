{% load setclass %}

<form class="savebyjs" action="" method="POST">
  {% csrf_token %}
  
  
  <div class="well" id="meeting_details">
      <h1><small>Meeting details</small></h1>
      
        <div class="panel panel-primary">
	  	  {{ meeting_form}}
	    </div><!-- ./panel -->
 
      </div><!-- ./well -->
  
 
  {% for item in item_formlist %}

    
    <div class="panel panel-primary" id="id_{{ item.item_no.value}}-title">
      
      <div class="panel-heading">
        {% ifequal item.added_in_meeting.value True %}
          <strong>Item&nbsp;{{ item.item_no.value }}.&nbsp;
                  {{ item.title|setclass:"form-control" }}</strong>
          <div class="pull-right">
            <button type="button" title="Delete item" 
              class="btn btn-default btn-xs ajax-button tltip"
              id="delete_item_{{ item.item_no.value}}" data-toggle="tooltip" >
                <span class="glyphicon glyphicon-remove">Delete</span>
            </button>
          </div>
        {% else %}
          <strong>Item&nbsp;{{ item.item_no.value }}.&nbsp;
                  {{ item.title.value }}</strong>                
          <div class="pull-right">
            {{ item.time_limit.value }}&nbsp;minutes		
          </div>
        {% endifequal %}
      </div>
      
      <div class="panel-body">
      
        <div class="form-group">
          <div class="well well-sm">
            To be explained by&nbsp;{{ item.explainer.value }}
            <br/>
          </div>
        </div>
        
        <div class="form-group">
          {{ item.background.label_tag }}
          <div class="well">
            {{ item.background.value }}
          </div>
        </div>
        
        <div class="form-group">
          {{ item.minute_notes.label_tag }}
          {{ item.minute_notes|setclass:"form-control" }}
        </div>
        
        {% for hidden in item.hidden_fields %}
          <div class="form-group">
            {{ hidden }}
          </div>
        {% endfor %}


        <p><strong>Decisions:</strong></p>
        <div class="panel panel-default">
          {% for decision in decision_formlist %}
            {% ifequal decision.instance.item.id item.instance.id %}
              <div class="form-group">
                {{ decision.label_tag }}
                {{ decision.description|setclass:"form-control" }}
                <button type="button" title="Delete decision" 
                  class="btn btn-default btn-xs ajax-button tltip"
                  id="delete_decision_{{ decision.instance.id}}"
                  data-toggle="tooltip" >
                  <span class="glyphicon glyphicon-remove">Delete</span>
                </button>
              </div>
            {% endifequal %}
          {% endfor %}

          <button id="add_decision_{{ item.instance.id }}"
            class="btn btn-default ajax-button" type="button">
              Add a decision to this item
          </button>
          
        </div>


        <p><strong>Tasks:</strong></p>
        
        <div class="panel panel-default">
          {% for task in task_formlist %}
            {% ifequal task.instance.item.id item.instance.id %}
              <div class="form-inline" role="form">
                <div class="form-group">
                  {{ task.description|setclass:"form-control" }}
                  {{ task.participant|setclass:"form-control" }}
                  {{ task.deadline|setclass:"form-control" }}
                  <button type="button" title="Delete task" 
                  class="btn btn-default btn-xs ajax-button tltip"
                  id="delete_task_{{ task.instance.id}}"
                  data-toggle="tooltip" >
                  <span class="glyphicon glyphicon-remove">Delete</span>
                </button>
                </div>
              </div>
            {% endifequal %}
          {% endfor %}

          <button id="add_task_{{ item.instance.id }}"
            class="btn btn-default ajax-button" type="button">
            Add a task to this item
          </button>
        </div>						

      </div>
    </div>
  {% endfor %}
</form>
